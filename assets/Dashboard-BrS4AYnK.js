import{a as m,h as I,ai as T,ah as e,ao as S}from"./index-DlZb9DCW.js";import{I as b,M as h,O as L,Q as x,T as Q,D as C,V as y,H as P}from"./IdurarOs-D9w05FI2.js";import{u as z}from"./useDate-DuhxoyiA.js";import{u as k}from"./useFetch-BmELsX3j.js";import{t as W}from"./statusTagColor-DxbKI3gy.js";import{s as B}from"./ErpApp-CtPnJ3L1.js";import{T as _}from"./index-fGz7MDv9.js";import{P as M}from"./progress-pBHZgWaU.js";import{S as G}from"./index-DJY1551C.js";var J={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},K=function(t,n){return m.createElement(b,I({},t,{ref:n,icon:J}))};const X=m.forwardRef(K);var Y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"},Z=function(t,n){return m.createElement(b,I({},t,{ref:n,icon:Y}))};const R=m.forwardRef(Z);function j({title:r,tagColor:t,data:n,prefix:s,isLoading:i=!1}){const{moneyFormatter:d}=z(),a=T(B);return e.jsx(h,{className:"gutter-row",xs:{span:24},sm:{span:12},md:{span:12},lg:{span:6},children:e.jsxs("div",{className:"whiteBox shadow",style:{color:"#595959",fontSize:13,minHeight:"106px",height:"100%"},children:[e.jsx("div",{className:"pad15 strong",style:{textAlign:"center",justifyContent:"center"},children:e.jsx("h3",{style:{color:"#22075e",fontSize:"large",margin:"5px 0",textTransform:"capitalize"},children:r})}),e.jsx(L,{style:{padding:0,margin:0}}),e.jsx("div",{className:"pad15",children:e.jsxs(x,{gutter:[0,0],justify:"space-between",wrap:!1,children:[e.jsx(h,{className:"gutter-row",flex:"85px",style:{textAlign:"left"},children:e.jsx("div",{className:"left",style:{whiteSpace:"nowrap"},children:s})}),e.jsx(L,{style:{height:"100%",padding:"10px 0",justifyContent:"center",alignItems:"center"},type:"vertical"}),e.jsx(h,{className:"gutter-row",flex:"auto",style:{display:"flex",justifyContent:"center",alignItems:"center"},children:i?e.jsx(S,{}):e.jsx(Q,{title:n,style:{direction:"ltr"},children:e.jsx(_,{color:t,style:{margin:"0 auto",justifyContent:"center",maxWidth:"110px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",direction:"ltr"},children:d(n?{amount:n,currency_code:a==null?void 0:a.default_currency_code}:{amount:0,currency_code:a==null?void 0:a.default_currency_code})})})})]})})]})})}const D={draft:"#595959",sent:"#1890ff",pending:"#1890ff",unpaid:"#ffa940",overdue:"#ff4d4f",partially:"#13c2c2",paid:"#95de64",declined:"#ff4d4f",accepted:"#95de64",cyan:"#13c2c2",purple:"#722ed1",expired:"#614700"},F=[{tag:"draft",value:0},{tag:"pending",value:0},{tag:"sent",value:0},{tag:"accepted",value:0},{tag:"declined",value:0},{tag:"expired",value:0}],ee=[{tag:"draft",value:0},{tag:"pending",value:0},{tag:"overdue",value:0},{tag:"paid",value:0},{tag:"unpaid",value:0},{tag:"partially",value:0}],te=({tag:r,color:t,value:n})=>{const s=C();return e.jsxs("div",{style:{color:"#595959",marginBottom:5},children:[e.jsx("div",{className:"left alignLeft capitalize",children:s(r)}),e.jsxs("div",{className:"right alignRight",children:[n," %"]}),e.jsx(M,{percent:n,showInfo:!1,strokeColor:{"0%":t,"100%":t}})]})};function ae({title:r="Preview",statistics:t=F,isLoading:n=!1,entity:s="invoice"}){const i=m.useMemo(()=>s==="invoice"?ee.map(a=>(Array.isArray(t)?t.find(c=>c.tag===a.tag):null)||a):F.map(a=>(Array.isArray(t)?t.find(c=>c.tag===a.tag):null)||a),[t,s]),d=(a,l)=>{const c=Object.values(D),v=c.indexOf(a.props.color),g=c.indexOf(l.props.color);return v-g};return e.jsx(h,{className:"gutter-row",xs:{span:24},sm:{span:24},md:{span:8},lg:{span:8},children:e.jsxs("div",{className:"pad20",children:[e.jsx("h3",{style:{color:"#22075e",fontSize:"large",marginBottom:40,marginTop:0},children:r}),n?e.jsx("div",{style:{textAlign:"center"},children:e.jsx(S,{})}):i==null?void 0:i.map((a,l)=>e.jsx(te,{tag:a.tag,color:D[a.tag],value:a==null?void 0:a.value},l)).sort(d)]})})}function re({isLoading:r=!1,activeCustomer:t=0,newCustomer:n=0}){const s=C();return e.jsx(x,{className:"gutter-row",children:e.jsx("div",{className:"whiteBox shadow",style:{height:458},children:e.jsxs("div",{className:"pad20",style:{textAlign:"center",justifyContent:"center"},children:[e.jsx("h3",{style:{color:"#22075e",marginBottom:40,marginTop:15,fontSize:"large"},children:s("Customers")}),r?e.jsx(S,{}):e.jsxs("div",{style:{display:"grid",justifyContent:"center"},children:[e.jsx(M,{type:"dashboard",percent:n,size:148}),e.jsx("p",{children:s("New Customer this Month")}),e.jsx(L,{}),e.jsx(G,{title:s("Active Customer"),value:t,precision:2,valueStyle:t>0?{color:"#3f8600"}:t<0?{color:"#cf1322"}:{color:"#000000"},prefix:t>0?e.jsx(R,{}):t<0?e.jsx(X,{}):null,suffix:"%"})]})]})})})}function ne(){const r=C(),{moneyFormatter:t}=z(),n=T(B),s=async({entity:o,currency:u})=>await P.summary({entity:o,options:{currency:u}}),{result:i,isLoading:d,onFetch:a}=y(),{result:l,isLoading:c,onFetch:v}=y(),{result:g,isLoading:N,onFetch:E}=y(),{result:se,isLoading:oe,onFetch:U}=y(),{result:p,isLoading:V}=k(()=>P.summary({entity:"client"}));m.useEffect(()=>{const o=n.default_currency_code||null;o&&(a(s({entity:"invoice",currency:o})),v(s({entity:"quote",currency:o})),E(s({entity:"offer",currency:o})),U(s({entity:"payment",currency:o})))},[n.default_currency_code]),r("number"),r("Total"),r("Status");const $=[{result:i,isLoading:d,entity:"invoice",title:"Orders"},{result:l,isLoading:c,entity:"quote",title:"Products"},{result:g,isLoading:N,entity:"offer",title:"Plans"}].map((o,u)=>{var O;const{result:w,entity:q,isLoading:A,title:H}=o;return e.jsx(ae,{title:H,isLoading:A,entity:q,statistics:!A&&((O=w==null?void 0:w.performance)==null?void 0:O.map(f=>({tag:f==null?void 0:f.status,color:"blue",value:f==null?void 0:f.percentage})))},u)});return n?e.jsxs(e.Fragment,{children:[e.jsxs(x,{gutter:[32,32],children:[e.jsx(j,{title:"Customers",tagColor:"cyan",prefix:r("This month"),isLoading:d,data:i==null?void 0:i.total}),e.jsx(j,{title:"Orders",tagColor:"purple",prefix:r("This month"),isLoading:c,data:l==null?void 0:l.total}),e.jsx(j,{title:"Plans",tagColor:"green",prefix:r("This month"),isLoading:N,data:g==null?void 0:g.total}),e.jsx(j,{title:"Products",tagColor:"red",prefix:r("Not Paid"),isLoading:d,data:i==null?void 0:i.total_undue})]}),e.jsx("div",{className:"space30"}),e.jsxs(x,{gutter:[32,32],children:[e.jsx(h,{className:"gutter-row w-full",sm:{span:24},md:{span:24},lg:{span:18},children:e.jsx("div",{className:"whiteBox shadow",style:{height:458},children:e.jsx(x,{className:"pad20",gutter:[0,0],children:$})})}),e.jsx(h,{className:"gutter-row w-full",sm:{span:24},md:{span:24},lg:{span:6},children:e.jsx(re,{isLoading:V,activeCustomer:p==null?void 0:p.active,newCustomer:p==null?void 0:p.new})})]}),e.jsx("div",{className:"space30"})]}):e.jsx(e.Fragment,{})}function xe(){return e.jsx(ne,{})}export{xe as default};
