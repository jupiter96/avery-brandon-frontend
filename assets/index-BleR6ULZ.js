import{a as h,h as H,ai as D,ah as t,ag as d,ap as M,aq as C}from"./index-DPRm9m9z.js";import{D as W,P as V,d as Y}from"./index-BoESmy8d.js";import{I as q,E as $,L as K,D as N,W as U,X,B as F,Y as G}from"./IdurarOs-CrOj2IRU.js";import{E as J,u as v,A as Q,a as Z,b as ee,R as te,F as ne,v as ae}from"./index-De8fGYLw.js";import{e as c}from"./actions-BQ9RmkEz.js";import{s as _,M as se}from"./index-DX5XU4RO.js";import{D as oe,E as ie}from"./ErpApp-3BGVMugZ.js";import{P as le}from"./PlusOutlined-m8xwXwNh.js";import{a as re,u as ce}from"./useDate-BBtjP0WA.js";var de={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M531.3 574.4l.3-1.4c5.8-23.9 13.1-53.7 7.4-80.7-3.8-21.3-19.5-29.6-32.9-30.2-15.8-.7-29.9 8.3-33.4 21.4-6.6 24-.7 56.8 10.1 98.6-13.6 32.4-35.3 79.5-51.2 107.5-29.6 15.3-69.3 38.9-75.2 68.7-1.2 5.5.2 12.5 3.5 18.8 3.7 7 9.6 12.4 16.5 15 3 1.1 6.6 2 10.8 2 17.6 0 46.1-14.2 84.1-79.4 5.8-1.9 11.8-3.9 17.6-5.9 27.2-9.2 55.4-18.8 80.9-23.1 28.2 15.1 60.3 24.8 82.1 24.8 21.6 0 30.1-12.8 33.3-20.5 5.6-13.5 2.9-30.5-6.2-39.6-13.2-13-45.3-16.4-95.3-10.2-24.6-15-40.7-35.4-52.4-65.8zM421.6 726.3c-13.9 20.2-24.4 30.3-30.1 34.7 6.7-12.3 19.8-25.3 30.1-34.7zm87.6-235.5c5.2 8.9 4.5 35.8.5 49.4-4.9-19.9-5.6-48.1-2.7-51.4.8.1 1.5.7 2.2 2zm-1.6 120.5c10.7 18.5 24.2 34.4 39.1 46.2-21.6 4.9-41.3 13-58.9 20.2-4.2 1.7-8.3 3.4-12.3 5 13.3-24.1 24.4-51.4 32.1-71.4zm155.6 65.5c.1.2.2.5-.4.9h-.2l-.2.3c-.8.5-9 5.3-44.3-8.6 40.6-1.9 45 7.3 45.1 7.4zm191.4-388.2L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-pdf",theme:"outlined"},ue=function(o,a){return h.createElement(q,H({},o,{ref:a,icon:de}))};const me=h.forwardRef(ue),{Content:pe}=K;function xe({children:e}){const o=D($);return t.jsx(J,{children:t.jsx(pe,{className:"whiteBox shadow layoutPadding",style:{margin:"30px auto",width:"100%",maxWidth:"1100px",minHeight:"600px",direction:o},children:e})})}const u=e=>e.erp;d([u],e=>e.current);const ye=d([u],e=>e.list);d([u],e=>e.create);d([u],e=>e.update);d([u],e=>e.recordPayment);d([u],e=>e.read);const he=d([u],e=>e.delete);d([u],e=>e.search);d([u],e=>e.mail);function fe({config:e}){const o=M(),{ADD_NEW_ENTITY:a,entity:s}=e,l=()=>{o(`/${s.toLowerCase()}/create`)};return t.jsx(F,{onClick:l,type:"primary",icon:t.jsx(le,{}),children:a})}function ge({config:e,extra:o=[]}){const a=N();let{entity:s,dataTableColumns:l,disableAdd:m=!1,searchConfig:i}=e;const{DATATABLE_TITLE:f}=e,{result:g,isLoading:b}=D(ye),{pagination:p,items:A}=g,{erpContextAction:E}=v(),{modal:j}=E,w=[{label:a("Show"),key:"read",icon:t.jsx(U,{})},{label:a("Edit"),key:"edit",icon:t.jsx(X,{})},{label:a("Download"),key:"download",icon:t.jsx(me,{})},...o,{type:"divider"},{label:a("Delete"),key:"delete",icon:t.jsx(W,{})}],L=M(),T=n=>{y(c.currentItem({data:n})),L(`/${s}/read/${n._id}`)},x=n=>{const r={...n};y(c.currentAction({actionType:"update",data:r})),L(`/${s}/update/${n._id}`)},I=n=>{window.open(`${G}${s}/${s}-${n._id}.pdf`,"_blank")},S=n=>{y(c.currentAction({actionType:"delete",data:n})),j.open()},R=n=>{y(c.currentItem({data:n})),L(`/invoice/pay/${n._id}`)};l=[...l,{title:"",key:"action",fixed:"right",render:(n,r)=>t.jsx(oe,{menu:{items:w,onClick:({key:k})=>{switch(k){case"read":T(r);break;case"edit":x(r);break;case"download":I(r);break;case"delete":S(r);break;case"recordPayment":R(r);break}}},trigger:["click"],children:t.jsx(ie,{style:{cursor:"pointer",fontSize:"24px"},onClick:k=>k.preventDefault()})})}];const y=C(),O=n=>{const r={page:n.current||1,items:n.pageSize||10};y(c.list({entity:s,options:r}))},z=()=>{y(c.list({entity:s}))};h.useEffect(()=>{const n=new AbortController;return z(),()=>{n.abort()}},[]);const B=n=>{const r={equal:n,filter:i==null?void 0:i.entity};y(c.list({entity:s,options:r}))},P=D($);return t.jsxs(t.Fragment,{children:[t.jsx(V,{title:f,ghost:!0,onBack:()=>window.history.back(),backIcon:P==="rtl"?t.jsx(Q,{}):t.jsx(Z,{}),extra:[t.jsx(ee,{entity:i==null?void 0:i.entity,displayLabels:["name"],searchFields:"name",onChange:B},`${_.generate()}`),t.jsx(F,{onClick:O,icon:t.jsx(te,{}),children:a("Refresh")},`${_.generate()}`),!m&&t.jsx(fe,{config:e},`${_.generate()}`)],style:{padding:"20px 0px",direction:P}}),t.jsx(ne,{columns:l,rowKey:n=>n._id,dataSource:A,pagination:p,loading:b,onChange:O,scroll:{x:!0}})]})}function be({config:e}){let{entity:o,deleteModalLabels:a,deleteMessage:s="Do you want delete : ",modalTitle:l="Remove Item"}=e;const m=C(),{current:i,isLoading:f,isSuccess:g}=D(he),{state:b,erpContextAction:p}=v(),{deleteModal:A}=b,{modal:E}=p,[j,w]=h.useState("");h.useEffect(()=>{if(g){E.close();const x={page:1,items:10};m(c.list({entity:o,options:x}))}if(i){let x=a.map(I=>ae(i,I)).join(" ");w(x)}},[g,i]);const L=()=>{const x=i._id;m(c.delete({entity:o,id:x})),E.close()},T=()=>{f||E.close()};return t.jsx(se,{title:l,open:A.isOpen,onOk:L,onCancel:T,confirmLoading:f,children:t.jsxs("p",{children:[s,j]})})}function Ae({config:e,extra:o}){const a=C(),{state:s}=v(),{deleteModal:l}=s,m=()=>{a(c.resetState())};return h.useLayoutEffect(()=>{const i=new AbortController;return m(),()=>{i.abort()}},[]),t.jsxs(t.Fragment,{children:[t.jsx(ge,{config:e,extra:o}),t.jsx(be,{config:e,isOpen:l.isOpen})]})}function Ee({config:e}){return t.jsx(xe,{children:t.jsx(Ae,{config:e})})}function ve(){const e=N(),{dateFormat:o}=re(),{moneyFormatter:a}=ce(),s={entity:"payment",displayLabels:["number"],searchFields:"number",outputValue:"_id"},l=["number"],m=[{title:e("Number"),dataIndex:"number"},{title:"Customer",dataIndex:["client","name"]},{title:e("Amount"),dataIndex:"amount",onCell:()=>({style:{textAlign:"right",whiteSpace:"nowrap",direction:"ltr"}}),render:(p,A)=>a({amount:p,currency_code:A.currency})},{title:e("Date"),dataIndex:"date",render:p=>Y(p).format(o)},{title:e("Number"),dataIndex:["invoice","number"]},{title:e("year"),dataIndex:["invoice","year"]},{title:e("Payment Mode"),dataIndex:["paymentMode","name"]}],b={...{entity:"payment",...{PANEL_TITLE:"Audit",DATATABLE_TITLE:"Audit Log",ADD_NEW_ENTITY:"Add New Log",ENTITY_NAME:"audit"}},disableAdd:!0,dataTableColumns:m,searchConfig:s,deleteModalLabels:l};return t.jsx(Ee,{config:b})}export{ve as default};
